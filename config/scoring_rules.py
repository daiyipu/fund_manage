"""
评分规则配置
根据《政府投资基金投向评价管理办法（试行）》定义
"""

SCORING_DIMENSIONS = {
    'POLICY': {
        'name': '政策符合性指标',
        'weight': 60.0,
        'max_score': 60.0,
        'indicators': [
            {
                'code': 'POLICY_01',
                'name': '支持新质生产力发展情况',
                'weight': 16.67,
                'max_score': 10.0,
                'scoring_guide': {
                    '10': '投向新质生产力领域比例≥90%',
                    '9': '投向新质生产力领域比例80%-90%（含80%）',
                    '8': '投向新质生产力领域比例70%-80%（含70%）',
                    '7': '投向新质生产力领域比例60%-70%（含60%）',
                    '6': '投向新质生产力领域比例50%-60%（含50%）',
                    '5': '投向新质生产力领域比例40%-50%（含40%）',
                    '4': '投向新质生产力领域比例30%-40%（含30%）',
                    '3': '投向新质生产力领域比例20%-30%（含20%）',
                    '2': '投向新质生产力领域比例10%-20%（含10%）',
                    '1': '投向新质生产力领域比例<10%',
                    '0': '未投向新质生产力领域'
                }
            },
            {
                'code': 'POLICY_02',
                'name': '支持科技创新和促进成果转化情况',
                'weight': 16.67,
                'max_score': 10.0,
                'scoring_guide': {
                    '10': '新增6项及以上成果（3分）+ 科技成果转化（2分）+ 支持多个"卡脖子"领域（5分）',
                    '9': '新增5项成果（2.5分）+ 科技成果转化（2分）+ 支持多个"卡脖子"领域（5分）或新增6项及以上成果+科技成果转化+支持一个"卡脖子"领域（3分）',
                    '8': '新增4项成果（2分）+ 科技成果转化（2分）+ 支持多个"卡脖子"领域（5分）或新增5项成果+科技成果转化+支持一个"卡脖子"领域',
                    '7': '新增3项成果（1.5分）+ 科技成果转化（2分）+ 支持多个"卡脖子"领域（5分）或新增4项成果+科技成果转化+支持一个"卡脖子"领域',
                    '6': '新增2项成果（1分）+ 科技成果转化（2分）+ 支持多个"卡脖子"领域（5分）或新增3项成果+科技成果转化+支持一个"卡脖子"领域',
                    '5': '新增1项成果（0.5分）+ 科技成果转化（2分）+ 支持多个"卡脖子"领域（5分）或新增2项及以上成果+科技成果转化+支持一个"卡脖子"领域',
                    '3': '支持多个"卡脖子"领域（5分）+ 无科技成果转化',
                    '5.5': '新增6项及以上成果（3分）+ 科技成果转化（2分）+ 不涉及"卡脖子"技术',
                    '5': '新增5项成果（2.5分）+ 科技成果转化（2分）+ 不涉及"卡脖子"技术',
                    '4.5': '新增4项成果（2分）+ 科技成果转化（2分）+ 不涉及"卡脖子"技术',
                    '4': '新增3项成果（1.5分）+ 科技成果转化（2分）+ 不涉及"卡脖子"技术',
                    '3.5': '新增2项成果（1分）+ 科技成果转化（2分）+ 不涉及"卡脖子"技术',
                    '3': '新增1项成果（0.5分）+ 科技成果转化（2分）+ 不涉及"卡脖子"技术',
                    '2': '支持一个"卡脖子"领域（3分）+ 无科技成果转化',
                    '0': '无新增成果且无科技成果转化且不涉及"卡脖子"技术'
                }
            },
            {
                'code': 'POLICY_03',
                'name': '推进全国统一大市场建设情况',
                'weight': 16.67,
                'max_score': 10.0,
                'scoring_guide': {
                    '10': '未设置返投要求（3分）+ 未设置注册地迁移条件（3分）+ 不存在违规行为（4分）',
                    '9': '返投比例<50%（3分）+ 未设置注册地迁移条件（3分）+ 不存在违规行为（4分）',
                    '8': '返投比例50%-100%（2分）+ 未设置注册地迁移条件（3分）+ 不存在违规行为（4分）',
                    '7': '返投比例100%-150%（1分）+ 未设置注册地迁移条件（3分）+ 不存在违规行为（4分）',
                    '6': '未设置返投要求（3分）+ 未设置注册地迁移条件（3分）+ 存在违规行为（0分）',
                    '5': '返投比例<50%（3分）+ 未设置注册地迁移条件（3分）+ 存在违规行为（0分）',
                    '4': '返投比例50%-100%（2分）+ 未设置注册地迁移条件（3分）+ 存在违规行为（0分）',
                    '3': '返投比例100%-150%（1分）+ 未设置注册地迁移条件（3分）+ 存在违规行为（0分）',
                    '0': '返投比例≥150%（0分）或设置了注册地迁移条件（0分）或存在违规行为（0分）'
                }
            },
            {
                'code': 'POLICY_04',
                'name': '支持绿色发展情况',
                'weight': 8.33,
                'max_score': 5.0,
                'scoring_guide': {
                    '5': '碳减排比例≥5%（3分）+ 投向比例>20%（2分）',
                    '4': '碳减排比例≥5%（3分）+ 投向比例≤20%（1分）',
                    '3': '碳减排比例3%-5%（2分）+ 投向比例>20%（2分）',
                    '2': '碳减排比例3%-5%（含3%）（2分）+ 投向比例≤20%（1分）或碳减排比例1%-3%（1分）+ 投向比例>20%（2分）',
                    '1': '碳减排比例1%-3%（1分）+ 投向比例≤20%（1分）或碳减排比例<1%或为负（0分）+ 投向比例>20%（2分）',
                    '0': '不涉及绿色发展领域（0分）或碳减排比例<1%或为负（0分）+ 投向比例≤20%（1分）'
                }
            },
            {
                'code': 'POLICY_05',
                'name': '支持民营经济发展和促进民间投资情况',
                'weight': 8.33,
                'max_score': 5.0,
                'scoring_guide': {
                    '5': '民营企业占比≥50%',
                    '4': '民营企业占比40%-50%（含40%）',
                    '3': '民营企业占比30%-40%（含30%）',
                    '2': '民营企业占比20%-30%（含20%）',
                    '1': '民营企业占比10%-20%（含10%）',
                    '0': '民营企业占比<10%'
                }
            },
            {
                'code': 'POLICY_06',
                'name': '壮大耐心资本情况',
                'weight': 8.33,
                'max_score': 5.0,
                'scoring_guide': {
                    '5': '投早投小占比≥70%或平均投资期≥5年',
                    '3': '投早投小占比50%-70%（含50%）或平均投资期3-5年（含3年）',
                    '2': '投早投小占比20%-50%（含20%）或平均投资期2-3年（含2年）',
                    '0': '投早投小占比<20%且平均投资期<2年'
                }
            },
            {
                'code': 'POLICY_07',
                'name': '带动社会资本情况',
                'weight': 8.33,
                'max_score': 5.0,
                'scoring_guide': {
                    '5': '社会资本占比≥50%',
                    '4': '社会资本占比40%-50%（含40%）',
                    '3': '社会资本占比30%-40%（含30%）',
                    '2': '社会资本占比20%-30%（含20%）',
                    '1': '社会资本占比10%-20%（含10%）',
                    '0': '社会资本占比<10%'
                }
            },
            {
                'code': 'POLICY_08',
                'name': '服务社会民生等其他重点领域情况',
                'weight': 16.67,
                'max_score': 10.0,
                'scoring_guide': {
                    '10': '排名前10%（5分）+ 涉及两个及以上重点领域（5分）',
                    '8': '排名前10%-30%（4分）+ 涉及两个及以上重点领域（5分）',
                    '7': '排名30%-50%（3分）+ 涉及两个及以上重点领域（5分）',
                    '6': '排名50%-70%（2分）+ 涉及两个及以上重点领域（5分）',
                    '5': '排名70%-90%（1分）+ 涉及两个及以上重点领域（5分）或排名前10%（5分）+ 涉及一个重点领域（3分）',
                    '4': '排名前10%-30%（4分）+ 涉及一个重点领域（3分）',
                    '3': '排名30%-50%（3分）+ 涉及一个重点领域（3分）或排名前10%（5分）+ 不涉及重点领域（0分）',
                    '2': '排名50%-70%（2分）+ 涉及一个重点领域（3分）或排名前10%-30%（4分）+ 不涉及重点领域（0分）',
                    '1': '排名70%-90%（1分）+ 涉及一个重点领域（3分）或排名30%-50%（3分）+ 不涉及重点领域（0分）',
                    '0': '排名90%以后（0分）且不涉及重点领域（0分）'
                }
            }
        ]
    },
    'LAYOUT': {
        'name': '优化生产力布局指标',
        'weight': 30.0,
        'max_score': 30.0,
        'indicators': [
            {
                'code': 'LAYOUT_01',
                'name': '落实国家区域战略情况',
                'weight': 33.33,
                'max_score': 10.0,
                'scoring_guide': {
                    '10': '投向符合国家区域战略要求',
                    '0': '投向不符合国家区域战略要求'
                }
            },
            {
                'code': 'LAYOUT_02',
                'name': '重点投向领域契合度',
                'weight': 33.33,
                'max_score': 10.0,
                'scoring_guide': {
                    '10': '重点投向领域比例≥90%',
                    '8': '重点投向领域比例70%-90%（含70%）',
                    '6': '重点投向领域比例50%-70%（含50%）',
                    '4': '重点投向领域比例30%-50%（含30%）',
                    '0': '重点投向领域比例<30%'
                }
            },
            {
                'code': 'LAYOUT_03',
                'name': '产能有效利用情况',
                'weight': 33.33,
                'max_score': 10.0,
                'scoring_guide': {
                    '10': '产能利用率高于行业平均水平（5分）+ 资产周转率≥100%（5分）',
                    '8': '产能利用率高于行业平均水平（5分）+ 资产周转率80%-100%（4分）',
                    '7': '产能利用率高于行业平均水平（5分）+ 资产周转率60%-80%（3分）',
                    '5': '产能利用率高于行业平均水平（5分）+ 资产周转率<60%（0分）',
                    '3': '产能利用率接近行业平均水平±5%以内（3分）+ 资产周转率≥100%（5分）',
                    '2': '产能利用率接近行业平均水平±5%以内（3分）+ 资产周转率80%-100%（4分）',
                    '1': '产能利用率接近行业平均水平±5%以内（3分）+ 资产周转率60%-80%（3分）',
                    '0': '产能利用率低于行业平均水平（0分）且资产周转率<60%（0分）'
                }
            }
        ]
    },
    'EXECUTION': {
        'name': '政策执行能力指标',
        'weight': 10.0,
        'max_score': 10.0,
        'indicators': [
            {
                'code': 'EXEC_01',
                'name': '资金效能情况',
                'weight': 40.0,
                'max_score': 4.0,
                'scoring_guide': {
                    '4': '出资完成比例≥50%（1分）+ 闲置资金占比<30%（1分）+ 内部收益率≥3%（1分）+ 资产增值率≥5%（1分）',
                    '3': '出资完成比例≥50%（1分）或0.5分 + 闲置资金占比<30%（1分）+ 内部收益率≥3%（1分）+ 资产增值率≥5%（1分）',
                    '2': '出资完成比例≥50%（1分）+ 闲置资金占比<30%（1分）+ 内部收益率≥3%（1分）或0分 + 资产增值率≥5%（1分）或0分',
                    '1.5': '出资完成比例30%-50%（0.5分）+ 闲置资金占比<30%（1分）+ 内部收益率≥3%（1分）+ 资产增值率≥5%（1分）',
                    '1': '出资完成比例≥50%（1分）+ 闲置资金占比<30%（1分）+ 内部收益率<3%（0分）+ 资产增值率<5%（0分）',
                    '0.5': '出资完成比例30%-50%（0.5分）+ 闲置资金占比≥30%（0分）+ 内部收益率<3%（0分）+ 资产增值率<5%（0分）',
                    '0': '出资完成比例<30%（0分）或闲置资金占比≥30%（0分）或内部收益率<3%（0分）或资产增值率<5%（0分）'
                }
            },
            {
                'code': 'EXEC_02',
                'name': '基金管理人专业水平',
                'weight': 60.0,
                'max_score': 6.0,
                'scoring_guide': {
                    '6': '高级管理人员从业年限>10年（1分）+ 有风险防控制度且无风险损失（1分）+ 信用情况较好（2分）+ 信息登记较好且披露透明度高（2分）',
                    '5': '高级管理人员从业年限>10年（1分）+ 有风险防控制度且无风险损失（1分）+ 信用情况较好（2分）+ 信息登记较好或披露透明度高（1分）',
                    '4': '高级管理人员从业年限>10年（1分）+ 有风险防控制度且无风险损失（1分）+ 信用情况较差（0分）+ 信息登记较好且披露透明度高（2分）',
                    '3': '高级管理人员从业年限>10年（1分）+ 有风险防控制度且无风险损失（1分）+ 信用情况较差（0分）+ 信息登记较好或披露透明度高（1分）',
                    '2': '高级管理人员从业年限>10年（1分）+ 有风险防控制度且无风险损失（1分）+ 信用情况较差（0分）+ 信息登记较差且披露透明度不足（0分）',
                    '1': '高级管理人员从业年限≤10年（0分）+ 有风险防控制度且无风险损失（1分）+ 信用情况较好（2分）+ 信息登记较好且披露透明度高（2分）',
                    '0': '无制度或发生风险损失/爆雷（0分）或高级管理人员从业年限≤10年（0分）且信用情况较差（0分）且信息登记较差且披露透明度不足（0分）'
                }
            }
        ]
    }
}

# 等级划分标准
GRADING_STANDARDS = {
    'excellent': {'min': 90.0, 'name': '优秀', 'color': '#52c41a'},
    'good': {'min': 80.0, 'name': '良好', 'color': '#1890ff'},
    'qualified': {'min': 60.0, 'name': '合格', 'color': '#faad14'},
    'unqualified': {'min': 0.0, 'name': '不合格', 'color': '#f5222d'}
}

# 角色权限定义
ROLE_PERMISSIONS = {
    'admin': {
        'can_create_project': True,
        'can_edit_project': True,
        'can_delete_project': True,
        'can_score': True,
        'can_approve': True,
        'can_view_all': True,
        'can_export': True,
        'can_manage_users': True,
        'can_view_statistics': True
    },
    'manager': {
        'can_create_project': True,
        'can_edit_project': True,
        'can_delete_project': False,
        'can_score': True,
        'can_approve': True,
        'can_view_all': True,
        'can_export': True,
        'can_manage_users': False,
        'can_view_statistics': True
    },
    'scorer': {
        'can_create_project': False,
        'can_edit_project': False,
        'can_delete_project': False,
        'can_score': True,
        'can_approve': False,
        'can_view_all': False,  # 只能查看分配给自己的项目
        'can_export': False,
        'can_manage_users': False,
        'can_view_statistics': False
    },
    'viewer': {
        'can_create_project': False,
        'can_edit_project': False,
        'can_delete_project': False,
        'can_score': False,
        'can_approve': False,
        'can_view_all': True,
        'can_export': True,
        'can_manage_users': False,
        'can_view_statistics': True
    }
}

# 角色名称映射
ROLE_NAMES = {
    'admin': '系统管理员',
    'manager': '部门负责人',
    'scorer': '评分专家',
    'viewer': '查看人员'
}
